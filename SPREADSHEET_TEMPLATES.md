# スプレッドシート構造テンプレート

このドキュメントでは、VTuberスクール成長度リザルトシステムで使用する各スプレッドシートの構造を詳しく説明します。

---

## 📊 1. 生徒マスタースプレッドシート

**目的**: 全生徒の基本情報を管理

### シート名: `生徒マスター`

### 列構成

| 列 | 項目名 | 説明 | 必須 | 例 |
|----|--------|------|------|-----|
| A | 学籍番号 | 生徒を一意に識別する番号 | ✅ | 2024001 |
| B | 氏名 | 生徒の氏名（フルネーム） | ✅ | 山田太郎 |
| C | トークメモフォルダURL | Google DriveフォルダのURL | ✅ | https://drive.google.com/drive/folders/1abc... |
| D | 入学年月 | YYYY-MM形式 | ⚪ | 2024-04 |
| E | ステータス | 在籍状況 | ⚪ | 在籍中 / 休学中 / 退学 |

### サンプルデータ

```
学籍番号	氏名		トークメモフォルダURL							入学年月	ステータス
2024001	山田太郎	https://drive.google.com/drive/folders/1abc...	2024-04	在籍中
2024002	佐藤花子	https://drive.google.com/drive/folders/1def...	2024-04	在籍中
2024003	鈴木次郎	https://drive.google.com/drive/folders/1ghi...	2024-05	休学中
```

### 注意事項

1. **ヘッダー行は必須**: 1行目に列名を入力
2. **データは2行目から**: システムはA2セルから読み取り
3. **学籍番号の形式**: 数字のみ、または年度+連番（例: 2024001）
4. **フォルダURLの取得方法**:
   - Google Driveでフォルダを開く
   - URLバーからコピー
   - `https://drive.google.com/drive/folders/【フォルダID】` の形式

5. **サービスアカウント権限**: 編集権限を付与

---

## 📊 2. 欠席データスプレッドシート

**目的**: 月次の欠席回数を記録

**スプレッドシートID**: `19dlNvTEp3SaFgXK7HWEamyhJDKpAODqoTnRhqOtNC4k`

### 列構成

| 列 | 項目名 | 説明 | 必須 | 例 |
|----|--------|------|------|-----|
| A | 学籍番号 | 生徒マスターと同じ形式 | ✅ | 2024001 |
| B | 欠席回数 | 対象月の欠席回数 | ✅ | 0, 1, 2, ... |
| C | 対象月 | YYYY-MM形式 | ✅ | 2024-12 |

### サンプルデータ

```
学籍番号	欠席回数	対象月
2024001	0		2024-12
2024002	1		2024-12
2024003	2		2024-12
2024001	0		2024-11
2024002	0		2024-11
```

### 評価基準

| 欠席回数 | 評価グレード |
|---------|-------------|
| 0回 | S |
| 1回 | A |
| 2回 | B |
| 3回 | C |
| 4回以上 | D |

### 注意事項

1. **月ごとにデータを追加**: 毎月データを蓄積
2. **対象月の形式**: 必ずYYYY-MM（例: 2024-12）
3. **サービスアカウント権限**: 閲覧権限でOK

---

## 📊 3. 支払いデータスプレッドシート

**目的**: 月次の支払い状況を記録

**スプレッドシートID**: `1z-FKQnVZj9gtZEAbOFqfSkQyYqTWkmeZjTBBbzVxRpo`

### シート名: `RAW_支払い状況`

### 列構成

| 列 | 項目名 | 説明 | 必須 | 例 |
|----|--------|------|------|-----|
| A | 学籍番号 | 生徒マスターと同じ形式 | ✅ | 2024001 |
| B | 支払い状況 | 支払いステータス | ✅ | 支払い済み / 未払い / 一部支払い |
| C | 対象月 | YYYY-MM形式 | ✅ | 2024-12 |

### サンプルデータ

```
学籍番号	支払い状況	対象月
2024001	支払い済み	2024-12
2024002	支払い済み	2024-12
2024003	一部支払い	2024-12
2024004	未払い		2024-12
```

### 評価基準

| 支払い状況 | 評価グレード |
|-----------|-------------|
| 支払い済み | S |
| 一部支払い | B |
| 未払い | D |

### 注意事項

1. **支払い状況の表記**: 正確に「支払い済み」「未払い」「一部支払い」と入力
2. **半角全角に注意**: システムは完全一致で判定
3. **サービスアカウント権限**: 閲覧権限でOK

---

## 📊 4. トークメモ（Googleドキュメント）

**目的**: レッスンの対話内容を記録

### 保存場所

- Google Drive上の学籍番号フォルダ内
- 例: `2024001` フォルダ → トークメモドキュメント

### ドキュメント形式

Gemini メモアプリで記録された対話形式のドキュメント

### 記述形式

```
先生: 今日のミッションは配信のOPトークを3分間考えることです。
山田太郎: はい、承知しました！
先生: それでは質問です。OPトークで大切なことは何ですか？
山田太郎: 視聴者を引き込むことだと思います。
先生: 正解です！他には？
山田太郎: 配信の内容を簡潔に伝えることです。
先生: その通りですね。では次の質問...
```

### 重要なルール

1. **発言者の識別**:
   - 先生の発言: 氏名に「先生」を含む（例: `先生:`, `田中先生:`）
   - 生徒の発言: 氏名に「先生」を含まない（例: `山田太郎:`, `佐藤花子:`）

2. **形式**:
   - `発言者: 発言内容` の形式
   - コロン（:）または全角コロン（:）で区切る

3. **AI分析項目**:
   - **遅刻**: トーク内で遅刻に関する言及があるか
   - **ミッション**: ミッションの達成度・取り組み姿勢
   - **アクティブリスニング**: 先生の話への反応・質問の質
   - **理解度**: 質問に対する正解数（最大5問想定）

### NG例

```
# ❌ 発言者が不明
今日は遅刻してしまいました
はい、大丈夫です

# ❌ コロンがない
先生 今日のミッションです
山田太郎 承知しました
```

### OK例

```
# ✅ 正しい形式
先生: 今日のミッションです
山田太郎: 承知しました

# ✅ 全角コロンもOK
田中先生:質問です
山田太郎:答えは〇〇です
```

### 注意事項

1. **複数のドキュメント**: フォルダ内に複数ある場合、最新のものを自動選択
2. **サービスアカウント権限**: フォルダとドキュメントに閲覧権限を付与
3. **文字数制限**: 特になし（ただし極端に長いと処理時間増加）

---

## 📊 5. 結果スプレッドシート

**目的**: 評価結果を自動記録

### シート名: `評価結果_YYYY-MM`

システムが自動で作成します（例: `評価結果_2024-12`）

### 列構成（システムが自動生成）

| 列 | 項目名 | 説明 |
|----|--------|------|
| A | 評価月 | YYYY-MM形式 |
| B | 学籍番号 | 生徒の学籍番号 |
| C | 氏名 | 生徒の氏名 |
| D | 欠席 | S〜Dグレード |
| E | 遅刻 | S〜Dグレード |
| F | ミッション | S〜Dグレード |
| G | 支払い | S〜Dグレード |
| H | アクティブリスニング | S〜Dグレード |
| I | 理解度 | S〜Dグレード |
| J | 総合評価 | S〜Dグレード（6項目の平均） |
| K | 評価日時 | ISO 8601形式 |

### サンプル出力

```
評価月	学籍番号	氏名		欠席	遅刻	ミッション	支払い	アクティブリスニング	理解度	総合評価	評価日時
2024-12	2024001	山田太郎	S	S	A		S		B				A		A		2024-12-11T10:30:00.000Z
2024-12	2024002	佐藤花子	A	S	B		S		A				B		B		2024-12-11T10:30:05.000Z
```

### 注意事項

1. **自動生成**: 手動編集不要（システムが書き込み）
2. **サービスアカウント権限**: 編集権限を付与
3. **複数月対応**: 月ごとに新しいシートが作成される

---

## 🔧 セットアップチェックリスト

各スプレッドシートの準備が完了したら、以下を確認してください：

- [ ] 生徒マスタースプレッドシート作成完了
- [ ] 欠席データスプレッドシート準備完了
- [ ] 支払いデータスプレッドシート準備完了  
- [ ] 結果スプレッドシート作成完了
- [ ] 各スプレッドシートにサービスアカウントを共有
- [ ] トークメモ用のDriveフォルダ作成（学籍番号ごと）
- [ ] トークメモフォルダにサービスアカウントを共有
- [ ] スプレッドシートIDをすべて控えた

---

## 📝 データ入力のベストプラクティス

### 1. 月初にデータを更新
- 欠席データ: 前月分を集計して入力
- 支払いデータ: 前月分の支払い状況を確認

### 2. トークメモは都度記録
- レッスン直後にGeminiメモで記録
- 発言者名を正確に入力
- 対話形式を維持

### 3. 生徒情報の更新
- 新入生: 学籍番号、氏名、フォルダURLを追加
- 休学・退学: ステータスを更新（削除しない）

### 4. データの一貫性
- 学籍番号の形式を統一
- 日付形式を統一（YYYY-MM）
- 支払い状況の表記を統一

---

**最終更新**: 2024-12-11  
**バージョン**: 1.0.0
