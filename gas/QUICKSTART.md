# トークメモフォルダURL自動入力 - クイックスタート

## 🚀 5分で始める

### ステップ1: スクリプトをコピー

1. **スプレッドシートを開く**
   - https://docs.google.com/spreadsheets/d/1MHRtvgDb-AWm7iBz9ova7KknwCrbcykp15ZtAlkbq-M/edit

2. **Apps Scriptエディタを開く**
   - メニューバー: `拡張機能` → `Apps Script`

3. **新しいスクリプトファイルを作成**
   - 左側の「ファイル」で `+` → `スクリプト`
   - ファイル名: `AutoFillTalkMemoUrls`

4. **コードをコピー＆ペースト**
   ```
   基本版: /home/user/webapp/gas/AutoFillTalkMemoUrls.gs
   拡張版: /home/user/webapp/gas/AutoFillTalkMemoUrls_Advanced.gs (フォルダ自動作成機能付き)
   ```

### ステップ2: 権限を承認

1. エディタ上部の「実行」ボタン（▶）をクリック
2. 「権限を確認」→ Googleアカウントを選択
3. 「詳細」→「（プロジェクト名）に移動」→ 「許可」

### ステップ3: 実行

1. スプレッドシートに戻る（ページをリロード）
2. メニューバーに「🔧 自動化ツール」が追加される
3. 「📁 トークメモフォルダURL自動入力」をクリック
4. 確認ダイアログで「はい」

### 完了！

E列にフォルダURLが自動入力されます 🎉

---

## 📋 2つのバージョン

### 基本版 (AutoFillTalkMemoUrls.gs)

**機能**:
- ✅ 既存フォルダのURLを自動入力
- ✅ URL検証機能
- ✅ フォルダ一覧表示

**使用シーン**:
- フォルダが既に作成済み
- URLの更新のみ必要

### 拡張版 (AutoFillTalkMemoUrls_Advanced.gs) - 推奨

**機能**:
- ✅ 既存フォルダのURLを自動入力
- ✅ **フォルダ自動作成機能**（新機能）
- ✅ URL検証機能
- ✅ フォルダ一覧表示

**使用シーン**:
- 新しい生徒が追加された
- フォルダがまだ作成されていない
- フォルダとURLを一度に設定したい

**メニュー**:
- `📁 トークメモフォルダURL自動入力` - 既存フォルダのみ
- `➕ トークメモフォルダURL自動入力（不足分を作成）` - フォルダ自動作成

---

## 🎯 実行結果例

### 成功

```
完了しました！

更新: 25件
未検出: 0件
```

### 一部不足（基本版）

```
完了しました！

更新: 22件
未検出: 3件

未検出の学籍番号:
OLTS240501-XX, OLTS240502-YY, OLTS240503-ZZ
```

### フォルダ自動作成（拡張版）

```
完了しました！

更新: 25件
作成: 3件

作成したフォルダ:
OLTS240501-XX, OLTS240502-YY, OLTS240503-ZZ
```

---

## 🔧 トラブルシューティング

### Q: メニューが表示されない

**A**: スプレッドシートをリロードしてください（F5キー）

### Q: 「フォルダが見つかりません」エラー

**A**: 以下を確認：
1. フォルダ名が学籍番号と完全一致しているか
2. フォルダが親フォルダ内にあるか
3. 大文字小文字、ハイフンが正しいか

**解決策**: 拡張版の「不足分を作成」機能を使用

### Q: 権限エラー

**A**: 再度権限を承認：
1. Apps Scriptエディタで「実行」
2. 権限の承認を再実行

---

## 📞 サポート

詳細なガイド: `/home/user/webapp/gas/TALK_MEMO_URL_SETUP.md`

---

**最終更新**: 2025-12-29
